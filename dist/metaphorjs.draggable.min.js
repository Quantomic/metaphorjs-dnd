'use strict';(function(){function K(a){return"object"==typeof a&&3===P(a)&&!a.nodeType&&a.constructor===Object}function X(a){return!0===a||!1===a}function s(a){return"function"==typeof a}function z(a){return"string"==typeof a||a===""+a}function Q(a){return"object"==typeof a&&5===P(a)}function Y(a){if(null===a||"object"!=typeof a)return!1;a=P(a);return 2<a||-1==a}function D(){}function L(){return!1}function M(){return!0}function R(a,b){var c;if(c=b)c=!(b&&Z("(?:^|\\s)"+b+"(?!\\S)").test(a.className));
c&&(a.className+=" "+b)}function H(a,b){b&&(a.className=a.className.replace(Z("(?:^|\\s)"+b+"(?!\\S)"),""))}function aa(a){var b={top:0,left:0},c=window.document.documentElement;if(!ja(a)||a===window)return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());return{top:b.top+ka()-c.clientTop,left:b.left+la()-c.clientLeft}}function S(a,b,c,d){return setTimeout(function(){a.apply(b,c||[])},d||0)}function I(a){if(!a)return!1;var b,c;return"object"!=(c=typeof a)&&"function"!=c?!1:s(b=a.then)?b:!1}
function N(a){var b=a.stack||Error().stack;if("undefined"!=typeof console&&console.log)S(function(){console.log(a);b&&console.log(b)});else throw a;}var F={},v=Array.prototype.slice,ma=Object.prototype.toString,P=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(b){if(!b){if(null===b)return 6;if(void 0===b)return 7}var c=a[ma.call(b)];return void 0===c?
-1:1==c&&isNaN(b)?8:c}}(),w=function(){return function b(){var c=!1,d=!1,e=v.call(arguments),k=e.shift(),g,f,l;X(e[e.length-1])&&(c=e.pop());X(e[e.length-1])&&(d=c,c=e.pop());for(;e.length;)if(g=e.shift())for(f in g)if(g.hasOwnProperty(f)&&void 0!==(l=g[f]))if(d)if(k[f]&&K(k[f])&&K(l))b(k[f],l,c,d);else{if(!0===c||void 0==k[f])K(l)?(k[f]={},b(k[f],l,c,!0)):k[f]=l}else if(!0===c||void 0==k[f])k[f]=l;return k}}(),p=Function.prototype.bind?function(a,b){return a.bind(b)}:function(a,b){return function(){return a.apply(b,
arguments)}},na=function(){var a,b=function(b){var d={},e=[];0==arguments.length&&(b=!0);return{addFinder:function(a,b,f){e[f?"unshift":"push"]({fn:a,context:b})},add:function(a,g,f){if(d[a]&&!1===d[a].rewritable)return d[a];d[a]={rewritable:"undefined"!=typeof f?f:b,value:g};return g},get:function(a){if(d[a])return d[a].value;if(e.length){var b,f,l;b=0;for(f=e.length;b<f;b++)if(l=e[b].fn.call(e[b].context,a,this),void 0!==l)return this.add(a,l,!0)}},remove:function(a){var b=d[a];b&&!0===b.rewritable&&
delete d[a];return b?b.value:void 0},exists:function(a){return!!d[a]},eachEntry:function(a,b){for(var f in d)a.call(b,d[f].value,f)},destroy:function(){this===a&&(a=null);this.remove=this.exists=this.destroy=this.get=this.add=b=d=null}}};b.global=function(){a||(a=new b(!0));return a};return b}(),T=function(){var a=function(a,d,e){e=e||new na(!1);var k=d?d.length:null;a||(a="undefined"!=typeof global?global:window);var g=function(a){return a&&d&&a.substr(0,k)!=d?d+"."+a:a},f=function(f,b){f=g(f);if(e.exists(f))return e.get(f);
if(!b){var h=f.split("."),n,r=h.length,E,k=a;for(n=0;n<r;n++)if(E=h[n],d&&0==n&&E==d)k=a;else{if(void 0===k[E])return;k=k[E]}k&&e.add(f,k);return k}};this.register=function(f,b){var h;h=g(f);var n=h.split("."),r,k=n.pop();r=n.join(".");var ba=n.length,q,t=a;if(e[r])h=[e[r],k,h];else{if(0<ba)for(r=0;r<ba;r++)q=n[r],d&&0==r&&q==d?t=a:(void 0===t[q]&&(t[q]={}),t=t[q]);h=[t,k,h]}n=h[0];k=h[1];Y(n)&&void 0===n[k]&&(n[k]=b,e.add(h[2],b));return b};this.exists=function(a){return void 0!==f(a,!0)};this.get=
f;this.add=function(a,f){a=g(a);e.add(a,f);return f};this.remove=function(a){a=g(a);e.remove(a)};this.normalize=g;this.makeAlias=function(a,f){a=g(a);f=g(f);var b=e.get(a);void 0!==b&&e.add(f,b)};this.destroy=function(){var a;this===b&&(b=null);e.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});e.destroy();e=null;for(a in this)this[a]=null}};a.prototype.register=null;a.prototype.exists=null;a.prototype.get=null;a.prototype.add=null;a.prototype.remove=null;a.prototype.normalize=null;a.prototype.makeAlias=
null;a.prototype.destroy=null;var b;a.global=function(){b||(b=new a);return b};return a}(),oa=function(a,b){var c=function(){},d;c.prototype=a.prototype;c=new c;d=a.apply(c,b);return Y(d)||!1===d?d:c},pa=function(a,b,c,d,e,k){e=e||"before";return function(){var g,f;if("instead"==e)return b.apply(c||d,arguments);"before"==e?(g=b.apply(c||d,arguments),f=!1!==g?a.apply(d||c,arguments):null):(f=a.apply(d||c,arguments),g=b.apply(c||d,arguments));return k?g:f}},A=function(){var a=function(){this.$super&&
this.$super!==D&&this.$super.apply(this,arguments)},b=function(a,f,b){var $super=a.prototype[f]||("$constructor"==f?a:D)||D;return function(){var a,f=this.$super;this.$super=$super;a=b.apply(this,arguments);this.$super=f;return a}},c=function(a,f,l,c){var h,n,d,e=l.prototype;for(h in f)f.hasOwnProperty(h)&&(d=e[h],n=f[h],a[h]=!s(n)||d&&!s(d)?n:b(l,h,n));c||(a.$plugins=null,e.$beforeInit?(a.$beforeInit=e.$beforeInit.slice(),a.$afterInit=e.$afterInit.slice(),a.$beforeDestroy=e.$beforeDestroy.slice(),
a.$afterDestroy=e.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},d=function(a,f){for(var b in f)f.hasOwnProperty(b)&&("$beforeInit"==b?a.$beforeInit.push(f[b]):"$afterInit"==b?a.$afterInit.push(f[b]):"$beforeDestroy"==b?a.$beforeDestroy.push(f[b]):"$afterDestroy"==b?a.$afterDestroy.push(f[b]):a[b]||(a[b]=f[b]))},e=function(b){b||(b=new T);var f=function(){return function(){var a=[],f=[],l=arguments,c,h,d,e,m;if(!this)throw"Must instantiate via new";
this.$plugins=[];(c=this.$constructor.apply(this,arguments))&&Q(c)&&(l=c);d=this.$plugins;c=-1;for(h=this.$beforeInit.length;++c<h;a.push([this.$beforeInit[c],this]));c=-1;for(h=this.$afterInit.length;++c<h;f.push([this.$afterInit[c],this]));if(d&&d.length)for(c=0,h=d.length;c<h;c++){e=d[c];if(z(e)&&(m=e,e=b.get(e,!0),!e))throw m+" not found";e=new e(this,l);e.$beforeHostInit&&a.push([e.$beforeHostInit,e]);e.$afterHostInit&&f.push([e.$afterHostInit,e]);d[c]=e}c=-1;for(h=a.length;++c<h;a[c][0].apply(a[c][1],
l));this.$init&&this.$init.apply(this,l);c=-1;for(h=f.length;++c<h;f[c][0].apply(f[c][1],l));}},l=function(){};w(l.prototype,{$class:null,$extends:null,$plugins:null,$mixins:null,$destroyed:!1,$constructor:D,$init:D,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$getParentClass:function(){return this.$extends},$intercept:function(a,f,b,l,c){var h=this[a];this[a]=pa(h,f,b||this,this,l,c);return h},$implement:function(a){var f=this.constructor;
f&&f.$parent&&c(this,a,f.$parent)},$destroy:function(){var a=this.$beforeDestroy,f=this.$afterDestroy,b=this.$plugins,l,c,h;if(!this.$destroyed){this.$destroyed=!0;l=-1;for(c=a.length;++l<c;a[l].apply(this,arguments));l=0;for(c=b.length;l<c;l++)b[l].$beforeHostDestroy&&b[l].$beforeHostDestroy.call(b[l],arguments);h=this.destroy.apply(this,arguments);l=-1;for(c=a.length;++l<c;f[l].apply(this,arguments));l=0;for(c=b.length;l<c;l++)b[l].$destroy.apply(b[l],arguments);if(!1!==h)for(l in this)this.hasOwnProperty(l)&&
(this[l]=null);this.$destroyed=!0}},destroy:function(){}});l.$self=l;l.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return oa(this,a)}};l.$override=function(a){var f=this.$self,b=this.$parent;f&&b&&c(f.prototype,a,b)};l.$extend=function(a,f){return m(a,f,this)};l.$destroy=function(){for(var a in this)this[a]=null};
var m=function(h,e,m){h=h||{};var k=h.$class,q=m||h.$extends,t=h.$mixins,s,u,p;q?z(q)?m=b.get(q):(m=q,q=m.$class||""):(m=l,q="");if(q&&!m)throw q+" not found";k&&(k=b.normalize(k));h.$class=k;h.$extends=q;h.$mixins=null;s=function(){};s.prototype=m.prototype;q=new s;s=null;h.$constructor=h.$constructor||a;c(q,h,m);if(t)for(h=0,s=t.length;h<s;h++)p=t[h],z(p)&&(p=b.get("mixin."+p,!0)),d(q,p);t=f();q.constructor=t;t.prototype=q;for(u in l)"prototype"!=u&&l.hasOwnProperty(u)&&(t[u]=l[u]);for(u in m)"prototype"!=
u&&m.hasOwnProperty(u)&&(t[u]=m[u]);if(e)for(u in e)"prototype"!=u&&e.hasOwnProperty(u)&&(t[u]=e[u]);t.$parent=m;t.$self=t;k&&b.register(k,t);return t},h=this;h.factory=function(a){var f=b.get(a),l=v.call(arguments,1);if(!f)throw a+" not found";return f.$instantiate.apply(f,l)};h.isSubclassOf=function(a,f){var l=a,c=b.get;f=z(f)?b.normalize(f):f.prototype.$class;for(z(a)&&(l=c(b.normalize(a)));l&&l.prototype;){if(l.prototype.$class==f)return!0;l=l.$parent}return!1};h.isInstanceOf=function(a,f){var l=
z(f)?b.get(f):f;return l?a instanceof l:!1};h.define=m;h.destroy=function(){h===k&&(k=null);l.$destroy();l=null;b.destroy();e=b=null};h.BaseClass=l};e.prototype={factory:null,isSubclassOf:null,isInstanceOf:null,define:null,destroy:null};var k;e.global=function(){k||(k=new e(T.global()));return k};return e}(),ca=new T(F,"MetaphorJs"),qa=(new A(ca)).define,da=function(){var a=["0","0","0"];return function(){for(var b=a.length,c;b;){b--;c=a[b].charCodeAt(0);if(57==c)return a[b]="A",a.join("");if(90==
c)a[b]="0";else return a[b]=String.fromCharCode(c+1),a.join("")}a.unshift("0");return a.join("")}}(),ea=function(){this.events={}};w(ea.prototype,{createEvent:function(a,b,c,d,e){a=a.toLowerCase();var k=this.events;k[a]||(k[a]=new U(a,b,c,d,e));return k[a]},getEvent:function(a){a=a.toLowerCase();return this.events[a]},on:function(a,b,c,d){a=a.toLowerCase();var e=this.events;e[a]||(e[a]=new U(a));return e[a].on(b,c,d)},once:function(a,b,c,d){d=d||{};d.limit=1;return this.on(a,b,c,d)},un:function(a,
b,c){a=a.toLowerCase();var d=this.events;d[a]&&d[a].un(b,c)},hasListener:function(a,b,c){var d=this.events;if(a)return a=a.toLowerCase(),d[a]?d[a].hasListener(b,c):!1;for(a in d)if(d[a].hasListener())return!0;return!1},removeAllListeners:function(a){var b=this.events;b[a]&&b[a].removeAllListeners()},trigger:function(){var a=arguments[0],b=this.events,a=a.toLowerCase();if(!b[a])return null;a=b[a];return a.trigger.apply(a,v.call(arguments,1))},suspendEvent:function(a){a=a.toLowerCase();var b=this.events;
b[a]&&b[a].suspend()},suspendAllEvents:function(){var a=this.events,b;for(b in a)a[b].suspend()},resumeEvent:function(a){a=a.toLowerCase();var b=this.events;b[a]&&b[a].resume()},resumeAllEvents:function(){var a=this.events,b;for(b in a)a[b].resume()},destroyEvent:function(a){var b=this.events;b[a]&&(b[a].removeAllListeners(),b[a].destroy(),delete b[a])},destroy:function(){var a=this.events,b;for(b in a)this.destroyEvent(b);for(b in this)this[b]=null},getApi:function(){if(!this.api){for(var a="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent".split(" "),
b={},c,d=-1,e=a.length;++d<e;c=a[d],b[c]=p(this[c],this));this.api=b}return this.api}},!0,!1);var U=function(a,b,c,d,e){this.name=a;this.listeners=[];this.map={};this.hash=da();this.uni="$$"+a+"_"+this.hash;this.suspended=!1;this.lid=0;"object"==typeof b&&null!==b?w(this,b,!0,!1):(this.returnResult=void 0===b?null:b,this.autoTrigger=c,this.triggerFilter=d,this.filterContext=e)};w(U.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,
lastTrigger:null,triggerFilter:null,filterContext:null,getName:function(){return this.name},destroy:function(){for(var a in this)this[a]=null},on:function(a,b,c){if(!a)return null;b=b||null;c=c||{};var d=this.uni,e=b||a;if(e[d]&&!c.allowDupes)return null;var k=++this.lid,g=c.first||!1;e[d]=k;a={fn:a,context:b,uniContext:e,id:k,called:0,limit:0,start:1,count:0,append:null,prepend:null};w(a,c,!0,!1);g?this.listeners.unshift(a):this.listeners.push(a);this.map[k]=a;if(this.autoTrigger&&this.lastTrigger&&
!this.suspended){var f=this.triggerFilter;this.triggerFilter=function(a){return a.id==k?f?!1!==f(a):!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=f}return k},once:function(a,b,c){c=c||{};c.once=!0;return this.on(a,b,c)},un:function(a,b){var c=-1,d=this.uni,e=this.listeners,k;k=a==parseInt(a)?a:(b||a)[d];if(!k)return!1;for(var g=0,f=e.length;g<f;g++)if(e[g].id==k){c=g;delete e[g].uniContext[d];break}if(-1==c)return!1;e.splice(c,1);delete this.map[k];return!0},hasListener:function(a,
b){var c=this.listeners,d;if(a){b=b||a;d=s(a)?b[this.uni]:a;if(!d)return!1;for(var e=0,k=c.length;e<k;e++)if(c[e].id==d)return!0;return!1}return 0<c.length},removeAllListeners:function(){var a=this.listeners,b=this.uni,c,d;c=0;for(d=a.length;c<d;c++)delete a[c].uniContext[b];this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(a,b){var c;a.append||a.prepend?(c=v.call(b),a.prepend&&(c=a.prepend.concat(c)),a.append&&(c=c.concat(a.append))):
c=b;return c},trigger:function(){var a=this.listeners,b=this.returnResult,c=this.triggerFilter,d=this.filterContext,e;if(this.suspended)return null;this.autoTrigger&&(this.lastTrigger=v.call(arguments));if(0==a.length)return null;for(var k="all"==b||"merge"==b?[]:null,g,a="first"==b?[a[0]]:v.call(a);g=a.shift();)if(g&&this.map[g.id]&&(e=this._prepareArgs(g,arguments),!c||!1!==c.call(d,g,e,this))&&(g.count++,!(g.count<g.start)))if(e=g.fn.apply(g.context,e),g.called++,g.called==g.limit&&this.un(g.id),
"all"==b)k.push(e);else if("merge"==b&&e)k=k.concat(e);else{if("first"==b||"nonempty"==b&&e)return e;if("last"==b)k=e;else if(!1==b&&!1===e)return!1}if(b)return k}},!0,!1);var ra=ca.add("mixin.Observable",{$$observable:null,$beforeInit:function(a){this.$$observable=new ea;if(a&&a.callback){var b=a.callback,c=b.context,d;b.context=null;for(d in b)if(b[d])this.$$observable.on(d,b[d],c||this);a.callback=null}},on:function(){var a=this.$$observable;return a.on.apply(a,arguments)},un:function(){var a=
this.$$observable;return a.un.apply(a,arguments)},once:function(){var a=this.$$observable;return a.once.apply(a,arguments)},trigger:function(){var a=this.$$observable;return a.trigger.apply(a,arguments)},$beforeDestroy:function(){this.$$observable.trigger("beforedestroy",this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.destroy();this.$$observable=null}}),x=function(a){if(a instanceof x)return a;if(!(this instanceof x))return new x(a);for(var b in a)if(!this[b])try{this[b]=
a[b]}catch(c){}this.originalEvent=a;this.type=a.type;!this.target&&a.srcElement&&(this.target=a.srcElement);var d,e=a.button;void 0===this.pageX&&null!==a.clientX&&(d=this.target?this.target.ownerDocument||window.document:window.document,b=d.documentElement,d=d.body,this.pageX=a.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||0),this.pageY=a.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0));this.which||void 0===e||(this.which=e&1?1:e&
2?3:e&4?2:0);this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?M:L;this.timeStamp=a&&a.timeStamp||(new Date).getTime()};w(x.prototype,{isDefaultPrevented:L,isPropagationStopped:L,isImmediatePropagationStopped:L,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=M;a.returnValue=!1;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=M;a&&a.stopPropagation&&a.stopPropagation()},
stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=M;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}},!0,!1);var fa=function(a){function b(){d=null}var c,d;a=function(a){return function(k){var g=new x(k||window.event),f=v.call(arguments,1),l=0,m=0,h=0,n=0,r=0,E=0;g.type="mousewheel";"detail"in g&&(h=-1*g.detail);"wheelDelta"in g&&(h=g.wheelDelta);"wheelDeltaY"in g&&(h=g.wheelDeltaY);"wheelDeltaX"in g&&(m=-1*g.wheelDeltaX);
"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(m=-1*h,h=0);l=0===h?m:h;"deltaY"in g&&(l=h=-1*g.deltaY);"deltaX"in g&&(m=g.deltaX,0===h&&(l=-1*m));if(0!==h||0!==m){n=Math.max(Math.abs(h),Math.abs(m));if(!d||n<d)d=n,"mousewheel"===g.type&&0===n%120&&(d/=40);"mousewheel"===g.type&&0===n%120&&(l/=40,m/=40,h/=40);l=Math[1<=l?"floor":"ceil"](l/d);m=Math[1<=m?"floor":"ceil"](m/d);h=Math[1<=h?"floor":"ceil"](h/d);this.getBoundingClientRect&&(n=this.getBoundingClientRect(),r=g.clientX-n.left,E=g.clientY-n.top);
g.deltaX=m;g.deltaY=h;g.deltaFactor=d;g.offsetX=r;g.offsetY=E;g.deltaMode=0;f.unshift(g,l,m,h);c&&clearTimeout(c);c=setTimeout(b,200);return a.apply(this,f)}}};a.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}(),B=function(){var a=null,b=null;return function(c,d,e){null===a&&(a=c.attachEvent?"attachEvent":"addEventListener",b=c.attachEvent?"on":"");if("mousewheel"==d){e=fa(e);d=fa.events();var k,
g;k=0;for(g=d.length;k<g;k++)c[a](b+d[k],e,!1)}else c[a](b+d,e,!1);return e}}(),V=function(){var a=null,b=null;return function(c,d,e){null===a&&(a=c.detachEvent?"detachEvent":"removeEventListener",b=c.detachEvent?"on":"");c[a](b+d,e)}}(),Z=function(){var a={};return function(b){return a[b]||(a[b]=new RegExp(b))}}(),ja=function(){return function b(c){if(c===window)return!0;if(3==c.nodeType)return c.parentElement?b(c.parentElement):!0;var d=window.document.documentElement;return c===d?!0:d.contains(c)}}(),
A=function(a){var b,c=a?"pageYOffset":"pageXOffset",d=a?"scrollTop":"scrollLeft";a=window.document;var e=a.body,k=a.documentElement;b=void 0!==window[c]?function(){return window[c]}:k.clientHeight?function(){return k[d]}:function(){return e[d]};return function(a){return a&&a!==window?a&&1==a.nodeType&&a!==e&&a!==k?a[d]:b():b()}},ka=A(!0),la=A(!1),ga=function(a,b,c){if(window.getComputedStyle){if(a===window)return b?c?0:null:{};a=getComputedStyle(a,null)}else a=a.currentStyle||a.style||{};b=b?a[b]:
a;return c?parseFloat(b)||0:b},sa=function(){var a;return function(){if(void 0===a){var b=window.document,c=b.createElement("div"),d=b.createElement("div"),b=b.body;d.style&&window.getComputedStyle?(c.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",c.appendChild(d),d.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",d.innerHTML=
"",b.appendChild(c),d="4px"===window.getComputedStyle(d,null).width,b.removeChild(c),a=d):a=!1}return a}}(),A=function(a,b){var c=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,d=["Top","Right","Bottom","Left"],e=a?"inner"==a?"padding":"":"content";return function(a,g){if(a===window)return a.document.documentElement["client"+b];if(9===a.nodeType){var f=a.documentElement;return Math.max(a.body["scroll"+b],f["scroll"+b],a.body["offset"+b],f["offset"+b],f["client"+b])}a:{var l=b.toLowerCase(),m=
e||(!0===g?"margin":"border"),f=ga(a),h=!0,n="width"===l?a.offsetWidth:a.offsetHeight,r="border-box"===f.boxSizing;if(0>=n||null==n){n=a.style[l];if(c.test(n)){f=n;break a}h=r&&(sa()||n===a.style[l]);n=parseFloat(n)||0}m=m||(r?"border":"content");l=m===(h?"border":"content")?4:"width"===l?1:0;for(r=0;4>l;l+=2)"margin"===m&&(r+=parseFloat(f[m+d[l]])),h?("content"===m&&(r-=parseFloat(f["padding"+d[l]])),"margin"!==m&&(r-=parseFloat(f["border"+d[l]+"Width"]))):(r+=parseFloat(f["padding"+d[l]]),"padding"!==
m&&(r+=parseFloat(f["border"+d[l]+"Width"])));f=n+r}return f}},ta=A("outer","Width"),ua=A("outer","Height"),O=function(){var a=["Moz","Webkit","ms","O","Khtml"],b="animationDelay",c="animationDuration",d="transitionDelay",e="transitionDuration",k="transform",g=null,f=null,l=!1;return function(){if(!l){var m=window.document.createElement("div"),h=!1,n,r,E;if(void 0!==m.style.animationName)h=!0;else for(r=0,E=a.length;r<E;r++)if(n=a[r],void 0!==m.style[n+"AnimationName"]){h=!0;b=n+"AnimationDelay";
c=n+"AnimationDuration";d=n+"TransitionDelay";e=n+"TransitionDuration";k=n+"Transform";break}h&&("ontransitionend"in window?g="transitionend":"onwebkittransitionend"in window&&(g="webkitTransitionEnd"));f=h?{animationDelay:b,animationDuration:c,transitionDelay:d,transitionDuration:e,transform:k,transitionend:g}:{};l=!0}return f}}(),ha=function(){var a=function(a){if(!a)return 0;var b=parseFloat(a);-1==a.indexOf("ms")&&(b*=1E3);return b},b=function(f,b,c){var h,d,e=b.length;for(h=0;h<e;h++)d=a(b[h])+
a(c[h]),f=Math.max(d,f);return f},c=!1,d=null,e=null,k=null,g=null;return function(a){!1===c&&(d=(c=O())?c.animationDuration:null,e=c?c.animationDelay:null,k=c?c.transitionDuration:null,g=c?c.transitionDelay:null);if(!c)return 0;var l=window.getComputedStyle?window.getComputedStyle(a,null):a.style;a=0;var m=(l[d]||"").split(","),h=(l[e]||"").split(","),n=(l[k]||"").split(","),l=(l[g]||"").split(",");a=Math.max(a,b(a,m,h));return a=Math.max(a,b(a,n,l))}}(),C=function(){var a={};return function(b,c,
d){b=b._mjsid||(b._mjsid=da());var e=a[b];return void 0!==d?(e||(e=a[b]={}),e[c]=d):e?e[c]:void 0}}(),va=function(a){var b=C(a,"mjsAnimationQueue"),c,d;if(Q(b)&&b.length){if(b=b[0])b.stages&&(c=b.position,d=b.stages,H(a,d[c]),H(a,d[c]+"-active")),b.deferred&&b.deferred.reject(b.el)}else s(b)?b(a):"stop"==b&&$(a).stop(!0,!0);C(a,"mjsAnimationQueue",null)},W=function(){var a=[],b=!1,c="undefined"!=typeof process?process.nextTick:function(a){setTimeout(a,0)},d=function(){b=!0;var f=a.shift();c(function(){f[0].apply(f[1],
f[2]);a.length?d():b=!1},0)},e=function(f,l,c){c=c||[];a.push([f,l,c]);b||d()},k=function(a,b){return function(c){try{b.resolve(a(c))}catch(h){b.reject(h)}}},g=function(a,b){if(a instanceof g)return a;if(!(this instanceof g))return new g(a,b);var c;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(c=I(a))a instanceof g?a.then(p(this.resolve,this),p(this.reject,this)):(new g(c,a)).then(p(this.resolve,this),p(this.reject,this));else if(s(a))try{a.call(b,p(this.resolve,
this),p(this.reject,this))}catch(h){this.reject(h)}else this.resolve(a)};w(g.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0==this._state},isFulfilled:function(){return 1==this._state},isRejected:function(){return 2==this._state},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,b){var c;if(0==this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));
else{try{if(c=I(a)){a instanceof g?a.then(p(this._processResolveValue,this),p(this._processRejectReason,this)):(new g(c,a)).then(p(this._processResolveValue,this),p(this._processRejectReason,this));return}}catch(h){0==this._state&&this._doReject(h);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)e(b[0],b[1],[this._value]);this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0==this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,
this._doResolve)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)e(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0==this._wait&&this._callRejectHandlers()},_processRejectReason:function(a){this._processValue(a,this._doReject)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);
return this},then:function(a,b){var c=new g,h=this._state;0==h||0!=this._wait?(a&&s(a)?this._fulfills.push([k(a,c),null]):this._fulfills.push([c.resolve,c]),b&&s(b)?this._rejects.push([k(b,c),null]):this._rejects.push([c.reject,c])):1==h?a&&s(a)?e(k(a,c),null,[this._value]):c.resolve(this._value):2==h&&(b&&s(b)?e(k(b,c),null,[this._reason]):c.reject(this._reason));return c},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,
this._value)}catch(c){N(c)}},done:function(a,b){var c=this._state;if(1==c&&0==this._wait)try{a.call(b||null,this._value)}catch(h){N(h)}else 0==c&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(c){N(c)}},fail:function(a,b){var c=this._state;if(2==c&&0==this._wait)try{a.call(b||null,this._reason)}catch(h){N(h)}else 0==c&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},
promise:function(){return{then:p(this.then,this),done:p(this.done,this),fail:p(this.fail,this),always:p(this.always,this)}},after:function(a){var b=this;if(I(a)){b._wait++;var c=function(){b._wait--;0==b._wait&&0!=b._state&&(1==b._state?b._callResolveHandlers():b._callRejectHandlers())};s(a.done)?a.done(c):a.then(c)}return b}},!0,!1);g.fcall=function(a,b,c){return g.resolve(a.apply(b,c||[]))};g.resolve=function(a){var b=new g;b.resolve(a);return b};g.reject=function(a){var b=new g;b.reject(a);return b};
g.all=function(a){if(!a.length)return g.resolve(null);var b=new g,c=a.length,h=Array(c),d=c,e,k,p=function(a,f){h[f]=a;d--;0==d&&b.resolve(h)};for(e=0;e<c;e++)(function(c){k=a[e];k instanceof g?k.done(function(a){p(a,c)}).fail(b.reject,b):I(k)||s(k)?(new g(k)).done(function(a){p(a,c)}).fail(b.reject,b):p(k,c)})(e);return b};g.when=function(){return g.all(arguments)};g.allResolved=function(a){if(!a.length)return g.resolve(null);var b=new g,c=a.length,h=[],d=c,e,k,p=function(a){h.push(a);q()},q=function(){d--;
0==d&&b.resolve(h)};for(e=0;e<c;e++)k=a[e],k instanceof g?k.done(p).fail(q):I(k)||s(k)?(new g(k)).done(p).fail(q):p(k);return b};g.race=function(a){if(!a.length)return g.resolve(null);var b=new g,c=a.length,h,d;for(h=0;h<c&&(d=a[h],d instanceof g?d.done(b.resolve,b).fail(b.reject,b):I(d)||s(d)?(new g(d)).done(b.resolve,b).fail(b.reject,b):b.resolve(d),b.isPending());h++);return b};g.waterfall=function(a){if(!a.length)return g.resolve(null);for(var b=a.shift(),b=s(b)?g.fcall(b):g.resolve(c),c;c=a.shift();)I(c)?
b=b.then(function(a){return function(){return a}}(c)):s(c)?b=b.then(c):b.resolve(c);return b};g.counter=function(a){var b=new g;b.countdown=function(){a--;0==a&&b.resolve()};return b};return g}(),J=function(){var a,b;if("undefined"!=typeof window){var c=window;a=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame;b=c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.webkitCancelRequestAnimationFrame;if(a)return function(c){var e=a(c);return function(){b(e)}}}return function(a){var b=
setTimeout(a,0);return function(){clearTimeout(b)}}}(),ia=function(){var a={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},b=0,c=!1,d=!1,e=function(a,b,c){var f=function(){(new Date).getTime()-b>=c?a():J(f)};J(f)},k=function(){!1===c&&(c=O(),d=!!c);return d},g=function m(a,b,c,f,d,k,p,s){var u=function(){var b=C(a,"mjsAnimationQueue");return b&&b.length&&b[0].id==p?!1:(d.reject(a),!0)},w=function(){if(!u()){var f=c;c++;if(c==b.length){d.resolve(a);C(a,
"mjsAnimationQueue").shift();var e=C(a,"mjsAnimationQueue");e.length?(e=e[0],g(e.el,e.stages,0,e.start,e.deferred,!1,e.id,e.step)):C(a,"mjsAnimationQueue",null)}else C(a,"mjsAnimationQueue")[0].position=c,m(a,b,c,null,d,!1,p,s);H(a,b[f]);H(a,b[f]+"-active")}},y=function(){u()||(R(a,b[c]+"-active"),W.resolve(s&&s(a,c,"active")).done(function(){if(!u()){var b=ha(a);b?e(w,(new Date).getTime(),b):J(w)}}))},z=function(){u()||(R(a,b[c]),W.waterfall([s&&s(a,c,"start"),function(){return f?f(a):null}]).done(function(){!u()&&
J(y)}))};k?J(z):z()},f=function(c,f,d,e,p,A){var q=new W,t=C(c,"mjsAnimationQueue")||[],B=++b,u=c.getAttribute?c.getAttribute("mjs-animate"):null,v,y,x,D,G,H,F;f=f||u;e&&null===u&&(f=null);if(f){z(f)?"["==f.substr(0,1)?v=(new Function("","return "+f))():(v=a[f],f=p&&p.get("animate."+f,!0)):s(f)?y=f:Q(f)&&(z(f[0])?v=f:(x=f[0],D=f[1]));K(f)&&(v=f.stages,y=f.fn,x=f.before,D=f.after,G=f.options?w({},f.options):{},H=f.context||null,F=f.duration||null,d=d||G.start);if(k()&&v)return t.push({el:c,stages:v,
start:d,step:A,deferred:q,position:0,id:B}),C(c,"mjsAnimationQueue",t),1==t.length&&g(c,v,0,d,q,!0,B,A),q;G=G||{};d&&(G.start=function(){d(c)});G.complete=function(){q.resolve(c)};F&&(G.duration=F);if(y&&s(y))return x&&w(c.style,x,!0,!1),d&&d(c),C(c,"mjsAnimationQueue",y.call(H,c,function(){q.resolve(c)})),q;if(window.jQuery){f=$(c);x&&f.css(x);C(c,"mjsAnimationQueue","stop");if(y&&z(y))return f[y](G),q;if(D)return f.animate(D,G),q}}d?(y=d(c),I(y)?y.done(function(){q.resolve(c)}):q.resolve(c)):q.resolve(c);
return q};f.addAnimationType=function(b,c){a[b]=c};f.stop=va;f.getPrefixes=O;f.getDuration=ha;f.cssAnimationSupported=k;return f}(),wa=function(){var a;return function(){if(null===a){var b=navigator.userAgent;a=parseInt((/msie (\d+)/i.exec(b)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/i.exec(b)||[])[1],10)||!1)}return a}}(),xa=function(){var a={},b;return function(c){if(void 0===a[c]){if("input"==c&&9==wa())return a[c]=!1;b||(b=window.document.createElement("div"));a[c]=!!("on"+c in
b)}return a[c]}}(),A=function(){var a=O(),b=a.transform,c=xa("touchstart"),d=!1,e=function(a,b){a=new x(a||window.event);var c,d,e,g;if(c=a.touches)for(d=0,e=c.length;d<e;d++)g=c[d].target,(b===g||b.contains(g))&&w(a,c[d],!0,!1);return a},k=function(a){a=new x(a||window.event);a.preventDefault();a.stopPropagation();return!1},g={draggable:null,blockDocumentEvents:!0,cls:{drag:null},start:{delay:0,distance:0,hold:0,holdThreshold:20,animate:!1},end:{restore:!1,animate:!1},drag:{method:"transform",axis:null},
cursor:{position:"click",offsetX:0,offsetY:0},drop:{enable:!1,to:null},events:{"*":{returnValue:!1,stopPropagation:!0,preventDefault:!0},touchstart:{returnValue:!0,stopPropagation:!1,preventDefault:!1}},helper:{destroy:!0,zIndex:9999,tpl:null,fn:null},placeholder:{tpl:null,fn:null},data:null,callback:{context:null,beforestart:null,start:null,beforeend:null,end:null,drag:null,drop:null,destroy:null}};return qa({$class:"Draggable",$mixins:[ra],draggable:null,delayTmt:null,holdTmt:null,startEvent:null,
lastMoveEvent:null,enabled:!0,started:!1,distance:!1,dragState:null,targetState:null,$constructor:function(a){w(a,g,!1,!0);this.$super(a)},$init:function(b){w(this,b,!0,!1);c&&!d&&this.blockDocumentEvents&&(b=window.document,B(b,"touchstart",k),B(b,"touchmove",k),B(b,"touchend",k),d=!0);a.transform||(this.drag.method="position");this.dragState={clickX:null,clickY:null,startX:null,startY:null,offsetX:null,offsetY:null,x:null,y:null};this.targetState={offsetX:null,offsetY:null};this.onMousedownDelegate=
p(this.onMousedown,this);this.onMousemoveDelegate=p(this.onMousemove,this);this.onMouseupDelegate=p(this.onMouseup,this);this.enabled&&(this.enabled=!1,this.enable())},enable:function(){this.enabled||(this.enabled=!0,this.setStartEvents("bind"))},disable:function(){this.enabled&&(this.enabled=!1,this.setStartEvents("unbind"))},setStartEvents:function(a){a="bind"==a?B:V;a(this.draggable,"mousedown",this.onMousedownDelegate);c&&a(this.draggable,"touchstart",this.onMousedownDelegate)},setMoveEvents:function(a){a=
"bind"==a?B:V;var b=document.documentElement,d=this.draggable;a(b,"mousemove",this.onMousemoveDelegate);a(b,"mouseup",this.onMouseupDelegate);c&&(a(d,"touchmove",this.onMousemoveDelegate),a(d,"touchend",this.onMouseupDelegate),a(d,"touchcancel",this.onMouseupDelegate))},processEvent:function(a){var b=this.events;if(b=b[a.type]||b["*"]){if(b.process)return b.process(a);b.stopPropagation&&a.stopPropagation();b.preventDefault&&a.preventDefault();return b.returnValue}},onMousedown:function(a){a=e(a,this.draggable);
this.dragStart(a);return this.processEvent(a)},dragStart:function(a){var b=this.start;if(this.enabled&&!this.started)if(this.startEvent=a,this.setMoveEvents("bind"),b.hold)this.holdTmt=S(this.onAfterDelay,this,[a],b.hold);else if(b.delay)this.delayTmt=S(this.onAfterDelay,this,[a],b.delay);else this.onAfterDelay(a)},onAfterDelay:function(a){var b=this.start,c=this.startEvent;this.holdTmt=this.delayTmt=null;b.distance?(this.distance=b.distance,this.dragState.clickX=c.clientX,this.dragState.clickY=c.clientY):
(this.onActualStart(a),this.dragMove(this.lastMoveEvent||a))},onActualStart:function(a){var b=this.startEvent;!1===this.trigger("beforestart",this,b)?this.dragStop(a):(this.started=!0,this.processStartEvent(),this.cacheOffsetParent(),this.cls.drag&&R(this.draggable,this.cls.drag),this.start.animate&&ia(this.draggable,["drag-start"],null,!1),this.trigger("start",this,b))},processStartEvent:function(){var a=this.startEvent,b=this.draggable,c=aa(b),d=this.cursor.position,e=this.dragState;e.clickX=a.clientX;
e.clickY=a.clientY;e.startX=c.left;e.startY=c.top;e.offsetX=e.clickX-c.left;e.offsetY=e.clickY-c.top;"click"!=d&&(a=ta(b),b=ua(b),-1!=d.indexOf("c")&&(e.offsetX=a/2,e.offsetY=b/2),-1!=d.indexOf("t")?e.offsetY=0:-1!=d.indexOf("b")&&(e.offsetY=b),-1!=d.indexOf("l")?e.offsetX=0:-1!=d.indexOf("r")&&(e.offsetX=a));e.offsetY-=this.cursor.offsetY;e.offsetX-=this.cursor.offsetX},cacheOffsetParent:function(){if(null===this.offsetParent){for(var a=window.document.documentElement,b=this.draggable.offsetParent||
a;b&&b!=a&&"static"==ga(b,"position");)b=b.offsetParent;this.offsetParent=b||a}a=aa(this.offsetParent||this.draggable);this.targetState.offsetX=a.left;this.targetState.offsetY=a.top},onMousemove:function(a){a=e(a,this.draggable);this.dragMove(a);return this.processEvent(a)},dragMove:function(a){var b=this.dragState;this.lastMoveEvent=a;if(!this.delayTmt)if(this.holdTmt)b=this.startEvent,(Math.abs(a.clientX-b.clientX)>=this.start.holdThreshold||Math.abs(a.clientY-b.clientY)>=this.start.holdThreshold)&&
this.dragStop(a);else{if(this.distance)if(Math.abs(a.clientX-b.clickX)>=this.distance||Math.abs(a.clientY-b.clickY)>=this.distance){if(this.distance=!1,this.onActualStart(a),!this.started)return}else return;"transform"==this.drag.method?this.applyTransform(a):this.applyPosition(a);this.trigger("drag",this,a)}},applyTransform:function(a){var c=this.draggable.style,d=this.dragState,e="",g=this.drag.axis,k=a.clientX-d.offsetX-this.targetState.offsetX;a=a.clientY-d.offsetY-this.targetState.offsetY;"x"!=
g&&(e+=" translateY("+a+"px)");"y"!=g&&(e+=" translateX("+k+"px)");d.x=k;d.y=a;c[b]=e},applyPositionFromTransform:function(){var a=this.draggable.style,c=this.drag.axis;"x"!=c&&(a.top=this.targetState.offsetY+this.dragState.y+"px");"y"!=c&&(a.left=this.targetState.offsetX+this.dragState.x+"px");a[b]=""},applyPosition:function(a){var b=this.draggable.style,c=this.drag.axis,d=this.dragState,e=a.clientX-d.offsetX;a=a.clientY-d.offsetY;"x"!=c&&(b.top=a+"px");"y"!=c&&(b.left=e+"px");d.x=e;d.y=a},restoreOriginalPosition:function(){var b=
this.draggable.style,c=this.dragState;"transform"==this.drag.method?b[a.transform]="":(b.top=c.startY+"px",b.left=c.startX+"px")},onMouseup:function(a){a=e(a,this.draggable);this.dragStop(a);return this.processEvent(a)},dragStop:function(a){this.setMoveEvents("unbind");this.lastMoveEvent=null;this.delayTmt?(clearTimeout(this.delayTmt),this.delayTmt=null):this.holdTmt?(clearTimeout(this.holdTmt),this.holdTmt=null):this.enabled&&this.started&&(this.trigger("beforeend",this,a),this.end.restore?this.restoreOriginalPosition():
"transform"==this.drag.method&&this.applyPositionFromTransform(),this.cls.drag&&H(this.draggable,this.cls.drag),this.end.animate&&ia(this.draggable,["drag-end"],null,!1),this.started=!1,this.trigger("end",this,a))},destroy:function(){this.disable()}})}();F.Draggable=A;F.onReady=function(a,b){var c=!1,d=!0,e=b||window,k,g,f=function(b){if("readystatechange"!=b.type||"complete"==g.readyState)V("load"==b.type?e:g,b.type,f),!c&&(c=!0)&&a.call(e,b.type||b)},l=function(){try{k.doScroll("left")}catch(a){setTimeout(l,
50);return}f("poll")};g=e.document;k=g.documentElement;if("complete"==g.readyState)a.call(e,"lazy");else{if(g.createEventObject&&k.doScroll){try{d=!e.frameElement}catch(m){}d&&l()}B(g,"DOMContentLoaded",f);B(g,"readystatechange",f);B(e,"load",f)}};"undefined"!=typeof global?global.MetaphorJs=F:window.MetaphorJs=F})();
